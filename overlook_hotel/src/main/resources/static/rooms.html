<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rooms - Overlook Hotel</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; }
        header { background-color: #333; color: #fff; padding: 1rem; text-align: center; }
        main { padding: 2rem; }
        .room-card { background: #fff; padding: 1rem; margin-bottom: 1rem; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .room-card h2 { margin: 0 0 0.5rem; }
        .features { list-style: none; padding: 0; margin: 0.5rem 0; display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .features li { background: #eee; padding: 0.25rem 0.5rem; border-radius: 4px; }
        button { padding: 0.5rem 1rem; border: none; background: #333; color: #fff; border-radius: 4px; cursor: pointer; }
        button:hover { background: #555; }
        #room-details { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                        background: rgba(0,0,0,0.7); justify-content: center; align-items: center; }
        #room-details .modal { background: #fff; padding: 2rem; border-radius: 8px; width: 90%; max-width: 500px; }
    </style>
</head>
<body>
<header>
    <h1>Nos Chambres</h1>
</header>
<main>
    <div id="rooms-container"></div>
</main>

<div id="room-details">
    <div class="modal">
        <h2 id="modal-room-number"></h2>
        <p>Capacité: <span id="modal-guest"></span> personne(s)</p>
        <p>Prix: <span id="modal-price"></span> € / nuit</p>
        <p>Occupation: <span id="modal-occupancy"></span></p>
        <ul id="modal-features" class="features"></ul>
        <button onclick="closeModal()">Fermer</button>
    </div>
</div>

<script>
const API_BASE = '/api/rooms'; 
const container = document.getElementById('rooms-container');
const modal = document.getElementById('room-details');

async function fetchRooms() {
    try {
        const res = await fetch(API_BASE);
        const rooms = await res.json();
        displayRooms(rooms);
    } catch (err) {
        container.innerHTML = '<p>Impossible de charger les chambres.</p>';
        console.error(err);
    }
}

function displayRooms(rooms) {
    container.innerHTML = '';
    rooms.forEach(room => {
        const card = document.createElement('div');
        card.className = 'room-card';
        card.innerHTML = `
            <h2>Chambre ${room.roomNumber}</h2>
            <p>Capacité: ${room.guest} personne(s)</p>
            <p>Prix: ${room.price} € / nuit</p>
            <p>Occupation: ${room.occupancy ? 'Occupée' : 'Disponible'}</p>
            <ul class="features">
                ${room.features.map(f => `<li>${f.name}</li>`).join('')}
            </ul>
            <button onclick='showDetails(${JSON.stringify(room)})'>Détails</button>
        `;
        container.appendChild(card);
    });
}

function showDetails(room) {
    document.getElementById('modal-room-number').textContent = `Chambre ${room.roomNumber}`;
    document.getElementById('modal-guest').textContent = room.guest;
    document.getElementById('modal-price').textContent = room.price;
    document.getElementById('modal-occupancy').textContent = room.occupancy ? 'Occupée' : 'Disponible';
    const featureList = document.getElementById('modal-features');
    featureList.innerHTML = room.features.map(f => `<li>${f.name}</li>`).join('');
    modal.style.display = 'flex';
}

function closeModal() {
    modal.style.display = 'none';
}

// fetch rooms on page load
fetchRooms();
</script>
</body>
</html>
